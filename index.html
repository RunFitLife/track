<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Run Fit Life</title>
  <meta name="theme-color" content="#111827">
  <style>
    :root { --bg:#f3f4f6; --card:#ffffff; --text:#111827; --muted:#6b7280; --primary:#111827; --danger:#b91c1c; --accent:#22c55e; }
    body.dark { --bg:#0f172a; --card:#020617; --text:#e5e7eb; --muted:#9ca3af; --primary:#e5e7eb; --accent:#4ade80; }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; margin:0; background:var(--bg); color:var(--text); line-height:1.4; }
    header { background:linear-gradient(135deg,#020617,#111827); color:#fff; padding:1.5rem 1rem; text-align:center; position:sticky; top:0; z-index:10; }
    header h1 { margin:0; font-size:1.6rem; }
    header p { margin:.25rem 0 .75rem; color:#d1d5db; }
    main { padding:1rem; max-width:900px; margin:auto; }
    h2 { margin-top:1.25rem; font-size:1.25rem; }
    h3 { margin-top:1rem; font-size:1.1rem; }
    form,.card { background:var(--card); padding:1rem; border-radius:18px; box-shadow:0 10px 25px rgba(0,0,0,.12); margin-bottom:1rem; }
    label { display:block; margin-top:.75rem; font-weight:600; font-size:.9rem; }
    input,textarea,select { width:100%; padding:.65rem .75rem; margin-top:.25rem; border-radius:10px; border:1px solid #374151; font-size:.95rem; background:var(--bg); color:var(--text); }
    textarea { resize:none; }
    button { padding:.65rem .9rem; border-radius:999px; border:none; font-weight:600; cursor:pointer; transition:.2s; }
    button:hover { transform:scale(1.02); }
    button.primary { background:var(--primary); color:var(--bg); width:100%; margin-top:1rem; }
    button.secondary { background:#6b7280; color:#fff; }
    button.danger { background:var(--danger); color:#fff; }
    button.icon { width:32px; height:32px; padding:0; display:flex; align-items:center; justify-content:center; border-radius:50%; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:.75rem; }
    .entry { background:var(--card); padding:.75rem 1rem; border-radius:14px; box-shadow:0 4px 12px rgba(0,0,0,.12); display:flex; justify-content:space-between; align-items:center; gap:.75rem; }
    .entry strong { font-size:.95rem; }
    .entry span { font-size:.85rem; color:var(--muted); }
    .badge { display:inline-block; padding:.25rem .6rem; border-radius:999px; font-size:.75rem; background:var(--accent); color:#022c22; font-weight:600; }
    footer { text-align:center; font-size:.8rem; color:var(--muted); margin:2rem 0 1rem; }
    canvas { width:100%; max-height:260px; margin-top:.5rem; }
  </style>
</head>
<body>
<header>
  
  <h1>Run Fit Life</h1>
  <p>Run towards a healthier life</p>
  <button class="small" type="button" onclick="toggleDark()">ğŸŒ™ / â˜€ï¸</button>
</header>
<main>

<form id="workoutForm">
  <h2>â• Nuevo entrenamiento</h2>
  <label>DÃ­a de rutina</label>
  <select id="day" required>
    <option>DÃ­a 1 - Empuje</option>
    <option>DÃ­a 2 - TirÃ³n</option>
    <option>DÃ­a 3 - Piernas y GlÃºteo</option>
  </select>

  <label>Ejercicio</label>
  <select id="exercise" required></select>

  <div class="row">
    <div><label>Peso (kg)</label><input type="number" id="weight" step="0.5" required></div>
    <div><label>Series</label><input type="number" id="sets" required></div>
  </div>

  <label>Repeticiones</label>
  <input type="number" id="reps" required>

  <label>Notas</label>
  <textarea id="notes"></textarea>

  <button type="submit">Guardar</button>
</form>

<div class="card">
  <h2>ğŸ” Selecciona fecha para ver tus ejercicios</h2>
  <input type="date" id="filterDate">
</div>
<div id="log"></div>

<div class="card">
  <h2>ğŸ“ˆ EstadÃ­sticas</h2>
  <canvas id="chart"></canvas>
  <p id="volume"></p>
  <p id="stats"></p>
</div>

<div class="card">
  <h2>ğŸ† Logros y medallas</h2>
  <div id="medals"></div>
  <p id="achievements"></p>
</div>

<div class="card">
  <h2>ğŸ“… Resumen semanal</h2>
  <p id="weeklySummary"></p>
</div>

<div class="card">
  <h2>ğŸ—“ï¸ Resumen mensual</h2>
  <p id="monthlySummary"></p>
</div>

<div class="card">
  <h2>ğŸ’ª RÃ©cords personales</h2>
  <p id="records"></p>
</div>

<div class="card">
  <h2>âš–ï¸ Control corporal mensual</h2>
  <form id="bodyForm">
    <label>Fecha</label>
    <input type="month" id="bodyDate" required>

    <div class="row">
      <div><label>Peso (kg)</label><input type="number" step="0.1" id="bodyWeight" required></div>
      <div><label>Agua (kg)</label><input type="number" step="0.1" id="bodyWater"></div>
    </div>

    <div class="row">
      <div><label>MÃºsculo (kg)</label><input type="number" step="0.1" id="bodyMuscle"></div>
      <div><label>Grasa (kg)</label><input type="number" step="0.1" id="bodyFat"></div>
    </div>

    <div class="row">
      <div><label>Hueso sin grasa (kg)</label><input type="number" step="0.1" id="bodyBone"></div>
      <div><label>Grasa visceral</label><input type="number" step="0.1" id="bodyVisceral"></div>
    </div>

    <button class="primary" type="submit">Guardar mediciÃ³n</button>
  </form>

  <h3>ğŸ“Š Comparativa mensual</h3>
  <canvas id="bodyChart"></canvas>
</div>

<div class="card">
  <h2>ğŸ“¦ GestiÃ³n de datos</h2>
  <button class="secondary" type="button" onclick="exportCSV()">Exportar CSV</button>
  <button class="secondary" type="button" onclick="exportBackup()">â¬‡ï¸ Copia de seguridad</button>
  <input type="file" id="importFile" accept="application/json" onchange="importBackup(event)">
  <button class="danger" type="button" onclick="clearAll()">Borrar todo</button>
</div>

</main>
<footer>Run Fit Life Â· PWA</footer>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const exercisesByDay={
  'DÃ­a 1 - Empuje':[ 'Press banca','Press banca inclinado','Press banca declinado','Aperturas en mÃ¡quina','Press militar','Elevaciones frontales','Elevaciones laterales','ExtensiÃ³n de trÃ­ceps','Fondos' ],
  'DÃ­a 2 - TirÃ³n':[ 'Remo con barra','JalÃ³n al pecho','Remo con polea','Face pull','Curl bÃ­ceps','Curl martillo' ],
  'DÃ­a 3 - Piernas y GlÃºteo':[ 'Sentadilla','Prensa','Peso muerto','Hip thrust','ExtensiÃ³n de cuÃ¡driceps','Femoral','Gemelos' ]
};

const STORAGE_KEY='gym_workouts';
const BODY_KEY='body_tracking';
const form=document.getElementById('workoutForm');
const daySelect=document.getElementById('day');
const exerciseSelect=document.getElementById('exercise');
const filterDate=document.getElementById('filterDate');
const log=document.getElementById('log');
const ctx=document.getElementById('chart');
const volumeEl=document.getElementById('volume');
const statsEl=document.getElementById('stats');
const achievementsEl=document.getElementById('achievements');
const medalsEl=document.getElementById('medals');
const weeklyEl=document.getElementById('weeklySummary');
const monthlyEl=document.getElementById('monthlySummary');
const recordsEl=document.getElementById('records');
let chart;
let bodyChart;

const getData=()=>JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
const saveData=d=>localStorage.setItem(STORAGE_KEY,JSON.stringify(d));

function updateExerciseOptions(){
  exerciseSelect.innerHTML='';
  exercisesByDay[daySelect.value].forEach(e=>{
    const o=document.createElement('option');
    o.textContent=e;
    exerciseSelect.appendChild(o);
  });
}

daySelect.addEventListener('change',updateExerciseOptions);

function refresh(){
  const data=getData();
  const filtered=filterDate.value?data.filter(w=>w.date===filterDate.value):data;
  renderLog(filtered);
  renderChart(filtered);
  renderStats(data);
  renderAchievements(data);
  renderMedals(data);
  renderWeekly(data);
  renderMonthly(data);
  renderRecords(data);
}

function renderLog(data){
  log.innerHTML='';
  data.forEach((w,i)=>{
    const e=document.createElement('div');
    e.className='entry';
    e.innerHTML=`<div><strong>${w.exercise}</strong><br>${w.weight}kg Â· ${w.sets}x${w.reps}</div>
    <button class="danger small" type="button" onclick="deleteEntry(${i})">ğŸ—‘ï¸</button>`;
    log.appendChild(e);
  });
}

function deleteEntry(index){
  const d=getData();
  d.splice(index,1);
  saveData(d);
  refresh();
}

function renderChart(data){
  if(chart) chart.destroy();
  if(!data.length){ volumeEl.textContent=''; return; }
  chart=new Chart(ctx,{type:'line',data:{labels:data.map(w=>w.date),datasets:[{label:'Peso',data:data.map(w=>w.weight)}]}});
  const totalVol=data.reduce((a,w)=>a+w.weight*w.sets*w.reps,0);
  volumeEl.textContent='Volumen total levantado: '+totalVol+' kg';
}

function renderStats(data){
  const days=[...new Set(data.map(w=>w.date))].length;
  statsEl.textContent=`DÃ­as totales entrenados: ${days}`;
}

function renderAchievements(data){
  const days=[...new Set(data.map(w=>w.date))].length;
  const messages=[
    'Hoy has invertido en tu salud ğŸ’š',
    'Cada entrenamiento cuenta ğŸ”¥',
    'EstÃ¡s construyendo un hÃ¡bito sÃ³lido ğŸ’ª',
    'No busques motivaciÃ³n, ya tienes disciplina ğŸ§ ',
    'Un dÃ­a mÃ¡s fuerte que ayer ğŸš€'
  ];
  let msg=`ğŸ—“ï¸ DÃ­as entrenados: ${days}<br><br>`;
  msg+=messages[Math.floor(Math.random()*messages.length)];
  achievementsEl.innerHTML=msg;
}

function renderMedals(data){
  medalsEl.innerHTML='';
  const days=[...new Set(data.map(w=>w.date))].length;
  const medals=[];
  if(days>=1) medals.push('ğŸ¥‰ Inicio');
  if(days>=10) medals.push('ğŸ¥ˆ Constancia');
  if(days>=30) medals.push('ğŸ¥‡ Disciplina');
  if(days>=60) medals.push('ğŸ… HÃ¡bito');
  if(days>=100) medals.push('ğŸ‘‘ Ã‰lite');
  medalsEl.innerHTML=medals.map(m=>`<span class="badge">${m}</span>`).join(' ');
}

function renderWeekly(data){
  const now=new Date();
  const weekAgo=new Date();
  weekAgo.setDate(now.getDate()-7);
  const count=data.filter(w=>new Date(w.date)>=weekAgo).length;
  weeklyEl.textContent=`Entrenamientos Ãºltimos 7 dÃ­as: ${count}`;
}

function renderMonthly(data){
  const now=new Date();
  const month=now.getMonth();
  const year=now.getFullYear();
  const count=data.filter(w=>{
    const d=new Date(w.date);
    return d.getMonth()===month && d.getFullYear()===year;
  }).length;
  monthlyEl.textContent=`Entrenamientos este mes: ${count}`;
}

function renderRecords(data){
  const max={};
  data.forEach(w=>{ max[w.exercise]=Math.max(max[w.exercise]||0,w.weight); });
  recordsEl.innerHTML=Object.keys(max).map(e=>`ğŸ‹ï¸ ${e}: ${max[e]} kg`).join('<br>');
}

function exportCSV(){
  const d=getData();
  let csv='Fecha,DÃ­a,Ejercicio,Peso,Series,Reps\n';
  d.forEach(w=>csv+=`${w.date},${w.day},${w.exercise},${w.weight},${w.sets},${w.reps}\n`);
  download(csv,'runfitlife.csv','text/csv');
}

function exportBackup(){ download(JSON.stringify(getData()),'backup.json','application/json'); }
function importBackup(e){ const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{ saveData(JSON.parse(r.result)); refresh(); }; r.readAsText(f); }
function clearAll(){ if(confirm('Â¿Seguro?')){ localStorage.removeItem(STORAGE_KEY); refresh(); } }
function download(c,n,t){ const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([c],{type:t})); a.download=n; a.click(); }
// ---- Control corporal ----
const getBodyData=()=>JSON.parse(localStorage.getItem(BODY_KEY))||[];
const saveBodyData=d=>localStorage.setItem(BODY_KEY,JSON.stringify(d));

const bodyForm=document.getElementById('bodyForm');
const bodyCtx=document.getElementById('bodyChart');

bodyForm.addEventListener('submit',e=>{
  e.preventDefault();
  const data=getBodyData();
  data.push({
    date:bodyDate.value,
    weight:+bodyWeight.value,
    water:+bodyWater.value||0,
    muscle:+bodyMuscle.value||0,
    fat:+bodyFat.value||0,
    bone:+bodyBone.value||0,
    visceral:+bodyVisceral.value||0
  });
  saveBodyData(data);
  bodyForm.reset();
  renderBodyChart();
});

function renderBodyChart(){
  const data=getBodyData();
  if(bodyChart) bodyChart.destroy();
  if(!data.length) return;
  bodyChart=new Chart(bodyCtx,{
    type:'line',
    data:{
      labels:data.map(d=>d.date),
      datasets:[
        {label:'Peso',data:data.map(d=>d.weight)},
        {label:'MÃºsculo',data:data.map(d=>d.muscle)},
        {label:'Grasa',data:data.map(d=>d.fat)}
      ]
    }
  });
}

function toggleDark(){ document.body.classList.toggle('dark'); }

form.addEventListener('submit',e=>{
  e.preventDefault();
  const d=getData();
  d.push({ day:daySelect.value, exercise:exerciseSelect.value, weight:+weight.value, sets:+sets.value, reps:+reps.value, notes:notes.value, date:new Date().toISOString().split('T')[0] });
  saveData(d);
  form.reset();
  updateExerciseOptions();
  refresh();
});

filterDate.addEventListener('change',refresh);
updateExerciseOptions();
refresh();
renderBodyChart();
</script>
</body>
</html>
