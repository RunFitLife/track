<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Run Fit Life</title>
<meta name="theme-color" content="#111827" />
<style>
:root{
  --bg:#f3f4f6;--card:#ffffff;--text:#111827;--muted:#6b7280;
  --primary:#111827;--danger:#b91c1c;--accent:#22c55e;
}
body.dark{
  --bg:#0f172a;--card:#020617;--text:#e5e7eb;
  --muted:#9ca3af;--primary:#e5e7eb;--accent:#4ade80;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);color:var(--text);line-height:1.4;
}
header{
  background:linear-gradient(135deg,#020617,#111827);
  color:#fff;padding:1.5rem 1rem;text-align:center;position:sticky;top:0;z-index:10;
}
header h1{margin:0;font-size:1.6rem}
header p{margin:.25rem 0 .75rem;color:#d1d5db}
main{padding:1rem;max-width:900px;margin:auto}
h2{margin-top:1.25rem;font-size:1.25rem}
h3{margin-top:1rem;font-size:1.05rem}
form,.card{
  background:var(--card);padding:1rem;border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.12);margin-bottom:1rem;
}
label{display:block;margin-top:.75rem;font-weight:600;font-size:.9rem}
input,textarea,select{
  width:100%;padding:.65rem .75rem;margin-top:.25rem;
  border-radius:10px;border:1px solid #374151;font-size:.95rem;
  background:var(--bg);color:var(--text);
}
textarea{resize:none}
button{
  padding:.65rem .9rem;border-radius:999px;border:none;
  font-weight:600;cursor:pointer;transition:.2s;
}
button:hover{transform:scale(1.02)}
button.primary{background:var(--primary);color:var(--bg);width:100%;margin-top:1rem}
button.secondary{background:#6b7280;color:#fff}
button.danger{background:var(--danger);color:#fff}
button.small{font-size:.75rem;padding:.3rem .6rem}
.row{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
.entry{
  background:var(--card);padding:.75rem 1rem;border-radius:14px;
  box-shadow:0 4px 12px rgba(0,0,0,.12);
  display:flex;justify-content:space-between;align-items:center;gap:.75rem;
}
.entry strong{font-size:.95rem}
.entry span{font-size:.85rem;color:var(--muted)}
.badge{
  display:inline-block;padding:.25rem .6rem;border-radius:999px;
  font-size:.75rem;background:var(--accent);color:#022c22;font-weight:600;
  margin:.15rem;
}
footer{text-align:center;font-size:.8rem;color:var(--muted);margin:2rem 0 1rem}
canvas{width:100%;max-height:260px;margin-top:.5rem}
</style>
</head>

<body>
<header>
  <h1>Run Fit Life</h1>
  <p>Run towards a healthier life</p>
  <button class="small" type="button" onclick="toggleDark()">üåô / ‚òÄÔ∏è</button>
</header>

<main>

<!-- ================= ENTRENAMIENTOS ================= -->
<form id="workoutForm">
  <h2>‚ûï Nuevo entrenamiento</h2>
  <label>D√≠a de rutina</label>
  <select id="day">
    <option>D√≠a 1 - Empuje</option>
    <option>D√≠a 2 - Tir√≥n</option>
    <option>D√≠a 3 - Piernas y Gl√∫teo</option>
    <option>D√≠a 4 - Abdominales</option>
  </select>

  <label>Ejercicio</label>
  <select id="exercise"></select>

  <div class="row">
    <div><label>Peso (kg)</label><input type="number" id="weight" step="0.5"></div>
    <div><label>Series</label><input type="number" id="sets"></div>
  </div>

  <label>Repeticiones</label>
  <input type="number" id="reps">

  <label>Notas</label>
  <textarea id="notes"></textarea>

  <button class="primary" type="submit">Guardar</button>
</form>

<div class="card">
  <h2>‚öñÔ∏è Control corporal mensual</h2>

  <div class="card">
    <h3>üìä √öltimo pesaje</h3>
    <div id="lastBody">No hay datos a√∫n</div>
  </div>

  <form id="bodyForm">
    <label>Fecha</label>
    <input type="month" id="bodyDate" required>

    <div class="row">
      <div><label>Peso (kg)</label><input type="number" step="0.1" id="bodyWeight" required></div>
      <div><label>Agua (kg)</label><input type="number" step="0.1" id="bodyWater"></div>
    </div>

    <div class="row">
      <div><label>M√∫sculo (kg)</label><input type="number" step="0.1" id="bodyMuscle"></div>
      <div><label>Grasa (kg)</label><input type="number" step="0.1" id="bodyFat"></div>
    </div>

    <div class="row">
      <div><label>Hueso (kg)</label><input type="number" step="0.1" id="bodyBone"></div>
      <div><label>Grasa visceral</label><input type="number" step="0.1" id="bodyVisceral"></div>
    </div>

    <button class="primary">Guardar medici√≥n</button>
  </form>

  <button class="secondary" onclick="toggleBodyHistory()">üìÇ Ver / ocultar historial</button>
  <div id="bodyHistory" style="display:none"></div>

  <canvas id="bodyChart"></canvas>
</div>

</main>

<footer>Run Fit Life ¬∑ PWA</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* ================== BODY ================== */
const BODY_KEY='body_tracking';
const qs=id=>document.getElementById(id);
let bodyChart=null;

function getBodyData(){return JSON.parse(localStorage.getItem(BODY_KEY))||[];}
function saveBodyData(d){localStorage.setItem(BODY_KEY,JSON.stringify(d));}

qs('bodyForm').addEventListener('submit',e=>{
  e.preventDefault();
  const d=getBodyData();
  d.push({
    date:qs('bodyDate').value,
    weight:+qs('bodyWeight').value,
    water:+qs('bodyWater').value||0,
    muscle:+qs('bodyMuscle').value||0,
    fat:+qs('bodyFat').value||0,
    bone:+qs('bodyBone').value||0,
    visceral:+qs('bodyVisceral').value||0
  });
  saveBodyData(d);
  e.target.reset();
  renderLastBody();
  renderBodyHistory();
  renderBodyChart();
});

function renderLastBody(){
  const d=getBodyData();
  const div=qs('lastBody');
  if(!d.length){div.textContent='No hay datos a√∫n';return;}
  const u=d[d.length-1];
  div.innerHTML=`
    <strong>${u.date}</strong><br>
    Peso: ${u.weight} kg<br>
    M√∫sculo: ${u.muscle} ¬∑ Grasa: ${u.fat}<br>
    Agua: ${u.water} ¬∑ Hueso: ${u.bone}<br>
    Grasa visceral: ${u.visceral}
  `;
}

function renderBodyHistory(){
  const d=getBodyData();
  const div=qs('bodyHistory');
  div.innerHTML='';
  if(!d.length){div.textContent='No hay registros';return;}
  d.forEach((x,i)=>{
    div.innerHTML+=`
      <div class="entry">
        <div>
          <strong>${x.date}</strong><br>
          <span>${x.weight}kg ¬∑ M√∫sculo ${x.muscle} ¬∑ Grasa ${x.fat}</span>
        </div>
        <button class="danger small" onclick="deleteBody(${i})">üóëÔ∏è</button>
      </div>`;
  });
}

function deleteBody(i){
  const d=getBodyData();
  d.splice(i,1);
  saveBodyData(d);
  renderLastBody();
  renderBodyHistory();
  renderBodyChart();
}

function toggleBodyHistory(){
  const d=qs('bodyHistory');
  d.style.display=d.style.display==='none'?'block':'none';
  renderBodyHistory();
}

function renderBodyChart(){
  const d=getBodyData();
  if(bodyChart) bodyChart.destroy();
  if(!d.length) return;
  bodyChart=new Chart(qs('bodyChart'),{
    type:'line',
    data:{
      labels:d.map(x=>x.date),
      datasets:[
        {label:'Peso',data:d.map(x=>x.weight)},
        {label:'M√∫sculo',data:d.map(x=>x.muscle)},
        {label:'Grasa',data:d.map(x=>x.fat)}
      ]
    }
  });
}

function toggleDark(){document.body.classList.toggle('dark');}

/* INIT */
renderLastBody();
renderBodyChart();
</script>

</body>
</html>
