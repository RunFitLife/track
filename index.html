<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Run Fit Life</title>
  <meta name="theme-color" content="#111827">
  <style>
    :root { --bg:#f3f4f6; --card:#ffffff; --text:#111827; --muted:#6b7280; --primary:#111827; --danger:#b91c1c; }
    body.dark { --bg:#0f172a; --card:#020617; --text:#e5e7eb; --muted:#9ca3af; --primary:#e5e7eb; }
    body { font-family: system-ui, sans-serif; margin:0; background:var(--bg); color:var(--text); }
    header { background:var(--primary); color:var(--bg); padding:1rem; text-align:center; }
    main { padding:1rem; max-width:900px; margin:auto; }
    h2,h3 { margin-top:1.5rem; }
    form,.card { background:var(--card); padding:1rem; border-radius:14px; box-shadow:0 4px 10px rgba(0,0,0,.15); }
    label { display:block; margin-top:.75rem; font-weight:600; }
    input,textarea,select,button { width:100%; padding:.6rem; margin-top:.25rem; border-radius:8px; border:1px solid #374151; font-size:1rem; background:var(--bg); color:var(--text); }
    button { background:var(--primary); color:var(--bg); border:none; margin-top:1rem; font-weight:600; }
    button.secondary { background:#6b7280; }
    button.danger { background:var(--danger); }
    button.small { font-size:.8rem; padding:.3rem .5rem; }
    .entry { background:var(--card); margin-top:.5rem; padding:.75rem; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,.15); display:flex; justify-content:space-between; gap:.5rem; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:.5rem; }
    footer { text-align:center; font-size:.85rem; color:var(--muted); margin:2rem 0; }
    canvas { width:100%; max-height:280px; }
  </style>
</head>
<body>
<header>
  <h1>ğŸ‹ï¸ Run Fit Life</h1>
  <p>Registra, analiza y mejora tus entrenamientos</p>
  <button class="small" onclick="toggleDark()">ğŸŒ™ / â˜€ï¸</button>
</header>
<main>

<form id="workoutForm">
  <h2>â• Nuevo entrenamiento</h2>
  <label>DÃ­a de rutina</label>
  <select id="day" required>
    <option>DÃ­a 1 - Empuje</option>
    <option>DÃ­a 2 - TirÃ³n</option>
    <option>DÃ­a 3 - Piernas y GlÃºteo</option>
  </select>

  <label>Ejercicio</label>
  <select id="exercise" required></select>

  <div class="row">
    <div><label>Peso (kg)</label><input type="number" id="weight" step="0.5" required></div>
    <div><label>Series</label><input type="number" id="sets" required></div>
  </div>

  <label>Repeticiones</label>
  <input type="number" id="reps" required>

  <label>Notas</label>
  <textarea id="notes"></textarea>

  <button type="submit">Guardar</button>
</form>

<div class="card">
  <h2>ğŸ” Selecciona fecha para ver tus ejercicios</h2>
  <input type="date" id="filterDate">
</div>
<div id="log"></div>

<div class="card">
  <h2>ğŸ“ˆ Progreso</h2>
  <canvas id="chart"></canvas>
  <p id="volume"></p>
  <p id="stats"></p>
  <p id="achievements"></p>
</div>

<div class="card">
  <h2>ğŸ“¦ GestiÃ³n de datos</h2>
  <button class="secondary" onclick="exportCSV()">Exportar CSV</button>
  <button class="secondary" onclick="exportBackup()">â¬‡ï¸ Copia de seguridad</button>
  <input type="file" id="importFile" accept="application/json" onchange="importBackup(event)">
  <button class="danger" onclick="clearAll()">Borrar todo</button>
</div>

</main>
<footer>Run Fit Life Â· PWA</footer>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const exercisesByDay={
  'DÃ­a 1 - Empuje':[ 'Press banca','Press banca inclinado','Press banca declinado','Aperturas en mÃ¡quina','Press militar','Elevaciones frontales','Elevaciones laterales con mancuernas','Elevaciones laterales con polea','ExtensiÃ³n de trÃ­ceps en polea','ExtensiÃ³n de trÃ­ceps tras nuca en polea','TrÃ­ceps katana','Fondos' ],
  'DÃ­a 2 - TirÃ³n':[ 'Remo con barra','JalÃ³n al pecho agarre neutro','Remo con polea','Pullover en polea','Face pull en polea','Aperturas posteriores con mancuernas','Reverse fly en mÃ¡quina','Curl de bÃ­ceps en banco Scott','Curl de bÃ­ceps codos atrÃ¡s en banco','Curl martillo' ],
  'DÃ­a 3 - Piernas y GlÃºteo':[ 'Zancada con saco','Peso muerto','Sentadillas en multipower','ExtensiÃ³n de cuÃ¡driceps','Prensa de pierna','Femoral unilateral','MÃ¡quina de abductor','MÃ¡quina de aductor','Hip thrust','GlÃºteo en mÃ¡quina','Gemelos' ]
};

const STORAGE_KEY='gym_workouts';
const form=document.getElementById('workoutForm');
const daySelect=document.getElementById('day');
const exerciseSelect=document.getElementById('exercise');
const filterDate=document.getElementById('filterDate');
const log=document.getElementById('log');
const ctx=document.getElementById('chart');
const volumeEl=document.getElementById('volume');
const statsEl=document.getElementById('stats');
const achievementsEl=document.getElementById('achievements');
let chart;

const getData=()=>JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
const saveData=d=>localStorage.setItem(STORAGE_KEY,JSON.stringify(d));

function updateExerciseOptions(){
  exerciseSelect.innerHTML='';
  const day = daySelect.value;
  if(exercisesByDay[day]){
    exercisesByDay[day].forEach(e=>{
      const o=document.createElement('option');
      o.textContent=e;
      exerciseSelect.appendChild(o);
    });
  }
}

daySelect.addEventListener('change',updateExerciseOptions);

function refresh(){
  const data=getData();
  let filtered=data;
  if(filterDate.value){
    filtered = data.filter(w=>w.date === filterDate.value);
  }
  renderLog(filtered);
  renderChart(filtered);
  renderStats(filtered);
  renderAchievements(data);
}

function renderLog(data){
  log.innerHTML='';
  data.forEach((w,i)=>{
    const e=document.createElement('div');
    e.className='entry';
    e.innerHTML=`<div><strong>${w.day} - ${w.exercise}</strong><br>${w.weight}kg Â· ${w.sets}x${w.reps}</div>
                   <button class='danger small' onclick='deleteEntry(${i})'>ğŸ—‘ï¸</button>`;
    log.appendChild(e);
  });
}

function deleteEntry(index){
  const data=getData();
  data.splice(index,1);
  saveData(data);
  refresh();
}

function renderChart(data){
  if(chart) chart.destroy();
  if(!data.length){ volumeEl.textContent=''; return; }
  chart=new Chart(ctx,{type:'line',data:{labels:data.map(w=>w.date),datasets:[{label:'Peso',data:data.map(w=>w.weight)}]}});
  const totalVol=data.reduce((a,w)=>a+w.weight*w.sets*w.reps,0);
  volumeEl.textContent='Volumen total levantado: '+totalVol+' kg';
}

function renderStats(data){
  if(!data.length){ statsEl.textContent=''; return; }
  const bestWeight=Math.max(...data.map(w=>w.weight));
  const totalExercises=data.length;
  statsEl.textContent=`Total de ejercicios: ${totalExercises} Â· Mayor peso levantado: ${bestWeight}kg`;
}

function renderAchievements(data){
  achievementsEl.innerHTML='';
  const totalSessions=data.length;
  const totalVolume=data.reduce((a,w)=>a+w.weight*w.sets*w.reps,0);
  let messages=[];
  if(totalSessions>=5) messages.push('ğŸ¯ Â¡5 entrenamientos completados! Sigue asÃ­!');
  if(totalSessions>=10) messages.push('ğŸ† Â¡10 entrenamientos completados! Eres imparable!');
  if(totalSessions>=20) messages.push('ğŸ’ª Â¡20 entrenamientos! Tu fuerza estÃ¡ creciendo!');
  if(totalVolume>=5000) messages.push('ğŸ”¥ Volumen total 5000kg levantado! Excelente trabajo!');
  if(totalVolume>=10000) messages.push('ğŸ‹ï¸ Volumen total 10000kg levantado! Nivel pro!');
  if(totalVolume>=20000) messages.push('ğŸš€ Volumen total 20000kg alcanzado! Leyenda del gimnasio!');
  if(totalSessions>0) messages.push('âœ¨ Â¡Cada repeticiÃ³n te acerca a tu mejor versiÃ³n!');
  if(totalSessions>5) messages.push('âš¡ Â¡Sigue empujando tus lÃ­mites!');
  achievementsEl.innerHTML=messages.join('<br>');
}

form.addEventListener('submit',e=>{
  e.preventDefault();
  const d=getData();
  const today=new Date().toISOString().split('T')[0];
  d.push({ day:daySelect.value, exercise:exerciseSelect.value, weight:+weight.value, sets:+sets.value, reps:+reps.value, notes:notes.value, date:today });
  saveData(d);
  form.reset();
  updateExerciseOptions();
  refresh();
});

filterDate.addEventListener('change',refresh);

function toggleDark(){document.body.classList.toggle('dark');}

updateExerciseOptions();
refresh();
</script>
</body>
</html>